<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>‡¶Ü‡¶Æ‡ßç‡¶Æ‡¶æ‡¶∞‡¶ï‡ßá ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶®!</title>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Hind Siliguri',system-ui,sans-serif;
  background:#fcf9c5;
  overflow:hidden;
}

/* Game container */
#game-container{
  position:relative;
  max-width:450px;
  height:100vh;
  margin:auto;
  background:#fcf9c5;
  overflow:hidden;
}

/* Top HUD */
#hud{
  position:absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:6px;
  background:#fff9c4;
  border:2px solid #e0cf8d;
  padding:8px 10px;
  border-radius:14px;
  z-index:999;
  font-weight:700;
}

.pill{
  background:#fff;
  padding:5px 8px;
  border-radius:10px;
  font-size:13px;
}

.hud-btn{
  border:none;
  border-radius:8px;
  padding:6px 10px;
  font-weight:700;
  cursor:pointer;
  background:#5c8aff;
  color:white;
}
.hud-btn.pause{ background:#999; }
.hud-btn.share{ background:#4caf50; }

/* Player */
#player{
  position:absolute;
  bottom:140px;
  left:50%;
  width:80px;
  height:80px;
  transform:translateX(-50%);
  background:url('ammar.png') no-repeat center/contain;
}

/* Enemy */
.enemy{
  position:absolute;
  width:55px;
  height:55px;
  background:url('bcl.png') no-repeat center/contain;
}

/* Overlay */
#overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.4);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:2000;
}

#modal{
  width:85%;
  background:white;
  border:4px solid #d32f2f;
  border-radius:18px;
  padding:20px;
  text-align:center;
}

#modal h2{color:#d32f2f;margin:0}
#modal p{font-weight:700}

.btn{
  width:100%;
  padding:12px;
  margin:8px 0;
  border:none;
  border-radius:10px;
  font-weight:800;
  cursor:pointer;
  color:white;
}

.btn.blue{background:#5c8aff}
.btn.gray{background:#aaa}
.btn.green{background:#4caf50}

/* Leaderboard */
#leaderboard{
  position:absolute;
  bottom:15px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  background:white;
  border:2px solid #5c8aff;
  border-radius:12px;
  padding:10px;
  text-align:center;
}

.lb-row{
  display:flex;
  justify-content:space-between;
  font-weight:700;
  font-size:14px;
}
</style>
</head>

<body>

<div id="game-container">

<!-- HUD -->
<div id="hud">
  <div class="pill">Score: <span id="score">0</span></div>
  <div class="pill">Time: <span id="time">00:00</span></div>

  <button class="hud-btn" id="btnStart">Start</button>
  <button class="hud-btn pause" id="btnPause">Pause</button>
  <button class="hud-btn share" id="btnShare">Share</button>
</div>

<!-- Player -->
<div id="player"></div>

<!-- Overlay -->
<div id="overlay">
  <div id="modal">
    <h2 id="modalTitle">Ready?</h2>
    <p id="modalText">Start ‡¶ö‡¶æ‡¶™‡¶≤‡ßá ‡¶ó‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá‡•§</p>

    <button class="btn blue" id="btnPrimary">Start</button>
    <button class="btn gray" id="btnClose">Close</button>

    <div id="extra"></div>
  </div>
</div>

<!-- Leaderboard -->
<div id="leaderboard">
  <h3>üèÜ ‡¶∏‡ßá‡¶∞‡¶æ ‡¶ñ‡ßá‡¶≤‡ßã‡ßü‡¶æ‡ßú</h3>
  <div id="lb"></div>
  <small>Powered by ‡¶™‡¶æ‡¶§‡¶æ ‡¶™‡¶æ‡¶ü‡ßã‡ßü‡¶æ‡¶∞‡ßÄ</small>
</div>

</div>

<script>
// ===== DOM =====
const container = document.getElementById("game-container");
const player = document.getElementById("player");

const scoreEl = document.getElementById("score");
const timeEl  = document.getElementById("time");

const overlay = document.getElementById("overlay");
const modalTitle = document.getElementById("modalTitle");
const modalText  = document.getElementById("modalText");
const extra = document.getElementById("extra");

const btnPrimary = document.getElementById("btnPrimary");
const btnClose = document.getElementById("btnClose");

const btnStart = document.getElementById("btnStart");
const btnPause = document.getElementById("btnPause");
const btnShare = document.getElementById("btnShare");

const lbEl = document.getElementById("lb");

// ===== State =====
let state="menu"; // menu,playing,paused,over
let score=0;
let startTime=0;
let last=0;
let enemies=[];

const LB_KEY="ammar_lb_v1";

// ===== Utils =====
function fmt(sec){
  return String(Math.floor(sec/60)).padStart(2,"0")+":"+
         String(sec%60).padStart(2,"0");
}

// ===== Overlay =====
function showOverlay(type){

  overlay.style.display="flex";
  extra.innerHTML="";

  if(type==="menu"){
    modalTitle.innerText="Ready?";
    modalText.innerText="Start ‡¶ö‡¶æ‡¶™‡¶≤‡ßá ‡¶ó‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá‡•§";

    btnPrimary.innerText="Start";
    btnPrimary.onclick=startGame;

    btnClose.style.display="block";
  }

  if(type==="paused"){
    modalTitle.innerText="Paused";
    modalText.innerText="Resume ‡¶ï‡¶∞‡¶§‡ßá Pause ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®";

    btnPrimary.innerText="Resume";
    btnPrimary.onclick=resumeGame;

    btnClose.style.display="block";
  }

  if(type==="over"){
    modalTitle.innerText="‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßá‡¶∑!";
    modalText.innerHTML=`‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßã‡¶∞: <b>${score}</b>`;

    btnPrimary.style.display="none";
    btnClose.style.display="none";

    extra.innerHTML=`
      <input id="name" placeholder="‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"><br>
      <button class="btn green" id="save">Save Score</button>
      <button class="btn blue" id="restart">Play Again</button>
    `;

    document.getElementById("save").onclick=saveScore;
    document.getElementById("restart").onclick=startGame;
  }
}

function hideOverlay(){
  overlay.style.display="none";
}

// ===== Game control =====
function startGame(){
  enemies.forEach(e=>e.el.remove());
  enemies=[];

  score=0;
  scoreEl.innerText=0;

  startTime=performance.now();
  last=startTime;

  state="playing";
  btnPause.innerText="Pause";

  hideOverlay();
}

function pauseGame(){
  if(state!=="playing")return;

  state="paused";
  btnPause.innerText="Resume";

  showOverlay("paused");
}

function resumeGame(){
  if(state!=="paused")return;

  state="playing";
  last=performance.now();
  btnPause.innerText="Pause";

  hideOverlay();
}

function gameOver(){
  state="over";
  showOverlay("over");
}

// ===== Input =====
container.addEventListener("pointermove",e=>{
  if(state==="over")return;

  const r=container.getBoundingClientRect();
  let x=e.clientX-r.left;

  x=Math.max(40,Math.min(r.width-40,x));
  player.style.left=x+"px";
});

// ===== Enemies =====
function spawn(){
  const el=document.createElement("div");
  el.className="enemy";

  let x=Math.random()*(container.clientWidth-55);

  container.appendChild(el);

  enemies.push({
    el,
    x,
    y:-60,
    speed:200+score*10
  });
}

function hit(a,b){
  return !(a.right<b.left||a.left>b.right||
           a.bottom<b.top||a.top>b.bottom);
}

// ===== Loop =====
let nextSpawn=0;

function loop(t){

  requestAnimationFrame(loop);

  if(state!=="playing")return;

  let dt=Math.min(.03,(t-last)/1000);
  last=t;

  timeEl.innerText=fmt((t-startTime)/1000|0);

  if(t>nextSpawn){
    spawn();
    nextSpawn=t+Math.max(400,1200-score*5);
  }

  const pr=player.getBoundingClientRect();

  for(let i=enemies.length-1;i>=0;i--){

    let o=enemies[i];

    o.y+=o.speed*dt;
    o.el.style.transform=
      `translate(${o.x}px,${o.y}px)`;

    const er=o.el.getBoundingClientRect();

    if(hit(pr,er)){
      gameOver();
      return;
    }

    if(o.y>window.innerHeight){
      o.el.remove();
      enemies.splice(i,1);
      score++;
      scoreEl.innerText=score;
    }
  }
}

requestAnimationFrame(t=>{last=t;loop(t)});

// ===== Share =====
btnShare.onclick=()=>{
  const text=`‡¶Ü‡¶Æ‡¶ø ${score} ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø!`;
  const url=location.href;

  if(navigator.share)
    navigator.share({text,url});
  else
    window.open(`https://wa.me/?text=${encodeURIComponent(text+" "+url)}`);
};

// ===== Leaderboard =====
function loadLB(){
  return JSON.parse(localStorage.getItem(LB_KEY)||"[]");
}

function saveScore(){

  const name=document.getElementById("name").value.trim();
  if(!name)return alert("‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®");

  let arr=loadLB();

  arr.push({name,score});

  arr.sort((a,b)=>b.score-a.score);

  localStorage.setItem(LB_KEY,JSON.stringify(arr.slice(0,10)));

  renderLB();
  alert("Saved!");
}

function renderLB(){

  let arr=loadLB();

  lbEl.innerHTML="";

  if(arr.length===0){
    lbEl.innerHTML="<small>No data</small>";
    return;
  }

  arr.forEach((x,i)=>{
    let d=document.createElement("div");
    d.className="lb-row";
    d.innerHTML=`${i+1}. ${x.name} <b>${x.score}</b>`;
    lbEl.appendChild(d);
  });
}

// ===== Buttons =====
btnStart.onclick=startGame;
btnPause.onclick=()=>state==="paused"?resumeGame():pauseGame();
btnClose.onclick=hideOverlay;

// Init
renderLB();
showOverlay("menu");
</script>

</body>
</html>
